{
  "openapi": "3.1.0",
  "info": {
    "title": "FDA Drug Information API",
    "description": "API for retrieving FDA drug label and NDC information",
    "version": "1.0.1"
  },
  "servers": [
    {
      "url": "https://medical-mcp-server.onrender.com",
      "description": "Medical MCP Server on Render"
    }
  ],
  "paths": {
    "/fda/v3/label-info": {
      "get": {
        "operationId": "getDrugLabelInfoV3",
        "summary": "Get optimized drug label information (v3)",
        "description": "Retrieve detailed drug label sections with 100% success rate using advanced LLM-optimized format. This endpoint includes token estimation, content truncation, and detailed metadata to help manage long content in LLM context windows.",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "description": "Generic or brand name of the drug (e.g., metformin or hydrocodone-acetaminophen)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fields",
            "in": "query",
            "description": "Comma-separated list of fields to retrieve (e.g., indications_and_usage,warnings)",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "optimize_for_llm",
            "in": "query",
            "description": "Apply LLM optimizations like truncation and token estimation",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true
            }
          },
          {
            "name": "max_content_length",
            "in": "query",
            "description": "Maximum content length before truncation (only used if optimize_for_llm=True)",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10000
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with optimized drug label information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Whether the request was successful"
                    },
                    "drug_name": {
                      "type": "string",
                      "description": "Name of the drug requested"
                    },
                    "fields": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      },
                      "description": "Label fields with their content"
                    },
                    "metadata": {
                      "type": "object",
                      "properties": {
                        "llm_optimization": {
                          "type": "object",
                          "properties": {
                            "applied": {
                              "type": "boolean",
                              "description": "Whether LLM optimizations were applied"
                            },
                            "field_status": {
                              "type": "object",
                              "additionalProperties": {
                                "type": "object"
                              },
                              "description": "Status of each field including truncation info"
                            },
                            "estimated_tokens": {
                              "type": "integer",
                              "description": "Estimated tokens in the response"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Drug information not found"
          },
          "500": {
            "description": "FDA API error"
          }
        }
      }
    },
    "/fda/v3/label-info/{field_name}": {
      "get": {
        "operationId": "getDrugLabelFieldV3",
        "summary": "Get specific field from drug label (v3)",
        "description": "Retrieve a single specific field from a drug label with higher character limits. Optimized for LLMs that need focused access to specific label sections like indications_and_usage or boxed_warning.",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "description": "Generic or brand name of the drug",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "field_name",
            "in": "path",
            "description": "Specific field to retrieve from the drug label (e.g., indications_and_usage)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "optimize_for_llm",
            "in": "query",
            "description": "Apply LLM optimizations like truncation and token estimation",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true
            }
          },
          {
            "name": "max_content_length",
            "in": "query",
            "description": "Maximum content length before truncation (higher for single field endpoint)",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 15000
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with the requested field",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "drug_name": {
                      "type": "string",
                      "description": "Name of the drug requested"
                    },
                    "field_name": {
                      "type": "string",
                      "description": "Name of the requested field"
                    },
                    "content": {
                      "type": "string",
                      "description": "Content of the requested field"
                    },
                    "metadata": {
                      "type": "object",
                      "properties": {
                        "llm_optimization": {
                          "type": "object",
                          "properties": {
                            "applied": {
                              "type": "boolean",
                              "description": "Whether LLM optimizations were applied"
                            },
                            "truncated": {
                              "type": "boolean",
                              "description": "Whether content was truncated"
                            },
                            "original_length": {
                              "type": "integer",
                              "description": "Original content length before truncation"
                            },
                            "estimated_tokens": {
                              "type": "integer",
                              "description": "Estimated tokens in the response"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Drug information not found"
          },
          "500": {
            "description": "FDA API error"
          }
        }
      }
    },
    "/fda/v3/available-fields": {
      "get": {
        "operationId": "listAvailableFieldsV3",
        "summary": "List available drug label fields (v3)",
        "description": "Get a list of all available fields that can be requested in the label-info endpoint.",
        "responses": {
          "200": {
            "description": "Successful response with available fields",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "standard_fields": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "List of standard fields available in the API"
                    },
                    "description": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "Additional information about the fields"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "FDA API error"
          }
        }
      }
    },
    "/fda/label-info": {
    "get": {
      "operationId": "getDrugLabelInfo",
      "summary": "Get comprehensive drug label information",
      "description": "Retrieve detailed drug label sections including indications, warnings, contraindications, and more. Uses intelligent fallback queries for reliable results. Recommended for accessing label text sections.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Brand name of the drug (e.g., Lipitor, Prozac)",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "ndc",
          "in": "query",
          "description": "NDC code of the drug (e.g., 0071-0156)",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "active_ingredient",
          "in": "query",
          "description": "Active ingredient of the drug (e.g., atorvastatin, fluoxetine)",
          "required": false,
          "schema": {
            "type": "string"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with drug label information",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "brand_name": {
                    "type": "string",
                    "description": "Brand name of the drug"
                  },
                  "generic_name": {
                    "type": "string",
                    "description": "Generic name of the drug"
                  },
                  "manufacturer": {
                    "type": "string",
                    "description": "Manufacturer of the drug"
                  },
                  "ndc": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "NDC codes associated with this drug"
                  },
                  "sections": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "Name of the label section"
                        },
                        "content": {
                          "type": "string",
                          "description": "Full text content of the label section"
                        }
                      }
                    },
                    "description": "Drug label sections including indications, warnings, etc."
                  },
                  "dosage_forms": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Available dosage forms"
                  },
                  "route": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Routes of administration"
                  },
                  "application_numbers": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "FDA application numbers"
                  },
                  "message": {
                    "type": "string",
                    "description": "Additional information about the response"
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request - missing required parameters"
        },
        "404": {
          "description": "No drug label information found matching the search criteria"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/fda/therapeutic-equivalence": {
      "get": {
        "deprecated": true,
        "operationId": "getDrugEquivalence",
        "summary": "[DEPRECATED] Get therapeutic equivalence information for drugs",
        "description": "[DEPRECATED - DO NOT USE] This endpoint has reliability issues and often fails to find reference products. Use /fda/orange-book/search instead for reliable therapeutic equivalence data.",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "description": "Brand name of the drug (e.g., Lipitor, Prozac)",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ndc",
            "in": "query",
            "description": "NDC code of the drug (e.g., 0071-0156)",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "active_ingredient",
            "in": "query",
            "description": "Active ingredient of the drug (e.g., atorvastatin, fluoxetine)",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "te_code",
            "in": "query",
            "description": "Filter by specific therapeutic equivalence code (e.g., 'AB', 'AB1')",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "group_by_te_code",
            "in": "query",
            "description": "Group equivalent products by their TE code for easier analysis",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": false
            }
          },
          {
            "name": "fields",
            "in": "query",
            "description": "Comma-separated fields to include in response",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of equivalent products to return",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 50
            }
          },
          {
            "name": "skip",
            "in": "query",
            "description": "Number of products to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 0
            }
          },
          {
            "name": "max_size",
            "in": "query",
            "description": "Apply maximum size restrictions to prevent context overflows",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with therapeutic equivalence data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "brand_name": {
                      "type": "string",
                      "description": "Brand name of the reference drug"
                    },
                    "active_ingredient": {
                      "type": "string",
                      "description": "Active ingredient of the drug"
                    },
                    "ndc": {
                      "type": "string",
                      "description": "NDC code of the reference drug"
                    },
                    "te_codes": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "Therapeutic equivalence codes (e.g., AB, AA)"
                    },
                    "reference_drug": {
                      "type": "boolean",
                      "description": "Whether this is a reference drug"
                    },
                    "equivalent_products": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "brand_name": {
                            "type": "string",
                            "description": "Brand name of the equivalent product"
                          },
                          "manufacturer": {
                            "type": "string",
                            "description": "Manufacturer of the equivalent product"
                          },
                          "ndc": {
                            "type": "string",
                            "description": "NDC code of the equivalent product"
                          },
                          "te_code": {
                            "type": "string",
                            "description": "Therapeutic equivalence code of the product"
                          },
                          "dosage_form": {
                            "type": "string",
                            "description": "Dosage form of the product (e.g., TABLET, CAPSULE)"
                          },
                          "strength": {
                            "type": "string",
                            "description": "Strength of the product (e.g., 10MG)"
                          },
                          "reference_drug": {
                            "type": "boolean",
                            "description": "Whether this product is a reference drug"
                          }
                        }
                      },
                      "description": "List of therapeutically equivalent products"
                    },
                    "grouped_by_te_code": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "array",
                        "items": {
                          "$ref": "#/components/schemas/EquivalentProduct"
                        }
                      },
                      "description": "Products grouped by therapeutic equivalence code when group_by_te_code=true"
                    },
                    "reference_drug_warning": {
                      "type": "string",
                      "description": "Warning message when multiple reference drugs are detected"
                    },
                    "search_method": {
                      "type": "string",
                      "description": "The successful search strategy used to find the reference product"
                    },
                    "search_attempts": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "List of all search strategies attempted"
                    },
                    "available_fields": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "List of available fields in the response for discoverability"
                    },
                    "metadata": {
                      "type": "object",
                      "properties": {
                        "query_parameters": {
                          "type": "object",
                          "properties": {
                            "name": { "type": "string" },
                            "ndc": { "type": "string" },
                            "active_ingredient": { "type": "string" },
                            "te_code": { "type": "string" },
                            "group_by_te_code": { "type": "boolean" },
                            "fields": { "type": "string" },
                            "limit": { "type": "integer" },
                            "skip": { "type": "integer" },
                            "max_size": { "type": "boolean" }
                          }
                        },
                        "pagination": {
                          "type": "object",
                          "properties": {
                            "is_paginated": { "type": "boolean" },
                            "total_count": { "type": "integer" },
                            "limit": { "type": "integer" },
                            "skip": { "type": "integer" },
                            "page": { "type": "integer" },
                            "total_pages": { "type": "integer" }
                          }
                        },
                        "size_optimization": {
                          "type": "object",
                          "properties": {
                            "applied": { "type": "boolean" },
                            "filtered_object_count": { "type": "integer" },
                            "selected_fields": {
                              "type": "array",
                              "items": { "type": "string" }
                            }
                          }
                        }
                      },
                      "additionalProperties": true,
                      "description": "Additional metadata about the query and results"
                    },
                    "message": {
                      "type": "string",
                      "description": "Additional information about the response"
                    },
                    "success": {
                      "type": "boolean",
                      "description": "Whether the API call was successful"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing required parameters"
          },
          "404": {
            "description": "No drug found matching the search criteria"
          },
          "500": {
            "description": "Server error processing the request"
          }
        }
      }
    },
    "/fda/label/search": {
      "get": {
        "operationId": "searchDrugLabel",
        "summary": "Get drug label information by name",
        "description": "Retrieves FDA drug label information including indications, usage, contraindications and more. NOT recommended for NDC data.",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "description": "Drug name to search for (e.g., apixaban, metformin, lisinopril)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fields",
            "in": "query",
            "description": "Specific fields to include (e.g., indications_and_usage, dosage_and_administration, warnings)",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with drug label information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["drug_name", "fields"],
                  "properties": {
                    "drug_name": {
                      "type": "string",
                      "description": "Name of the drug that was searched for"
                    },
                    "fields": {
                      "type": "array",
                      "description": "Array of field data containing names and corresponding values",
                      "items": {
                        "type": "object",
                        "required": ["field_name", "values"],
                        "properties": {
                          "field_name": {
                            "type": "string",
                            "description": "Name of the drug label field"
                          },
                          "values": {
                            "type": "array",
                            "description": "Array of text values for this field",
                            "items": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "openfda_data": {
                      "type": "object",
                      "description": "Additional OpenFDA metadata about the drug",
                      "additionalProperties": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid input parameters"
          },
          "404": {
            "description": "Drug not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/fda/ndc/compact_search": {
      "get": {
        "operationId": "searchNDCCompact",
        "summary": "Search FDA NDC directory for drug products",
        "description": "Retrieves detailed NDC (National Drug Code) information for drugs. RECOMMENDED endpoint for NDC data.",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "description": "Brand or generic name of the drug (e.g., warfarin, lipitor)",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "manufacturer",
            "in": "query",
            "description": "Name of the manufacturer",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "active_ingredient",
            "in": "query",
            "description": "Active ingredient in the drug",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ndc",
            "in": "query",
            "description": "Specific NDC code to search for",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "name": "skip",
            "in": "query",
            "description": "Number of results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with NDC product information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["total_results", "displayed_results", "products"],
                  "properties": {
                    "total_results": {
                      "type": "integer",
                      "description": "Total number of results found"
                    },
                    "displayed_results": {
                      "type": "integer",
                      "description": "Number of results included in this response"
                    },
                    "products": {
                      "type": "array",
                      "description": "List of drug products with NDC information",
                      "items": {
                        "type": "object",
                        "properties": {
                          "product_ndc": {
                            "type": "string",
                            "description": "NDC product code"
                          },
                          "brand_name": {
                            "type": "string",
                            "description": "Brand name of the drug"
                          },
                          "generic_name": {
                            "type": "string",
                            "description": "Generic name of the drug"
                          },
                          "dosage_form": {
                            "type": "string",
                            "description": "Dosage form (e.g., tablet, injection)"
                          },
                          "route": {
                            "type": "string",
                            "description": "Administration route (e.g., oral, intravenous)"
                          },
                          "marketing_status": {
                            "type": "string",
                            "description": "Marketing status of the drug"
                          },
                          "active_ingredients": {
                            "type": "array",
                            "description": "List of active ingredients with their strength",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "Name of the active ingredient"
                                },
                                "strength": {
                                  "type": "string",
                                  "description": "Strength of the ingredient"
                                }
                              }
                            }
                          },
                          "manufacturer_name": {
                            "type": "string",
                            "description": "Name of the manufacturer"
                          },
                          "packaging": {
                            "type": "array",
                            "description": "List of packaging variations with package-level NDC codes",
                            "items": {
                              "type": "object",
                              "properties": {
                                "package_ndc": {
                                  "type": "string",
                                  "description": "Package-level NDC code (e.g., 0088-2219-00)"
                                },
                                "description": {
                                  "type": "string",
                                  "description": "Description of the package"
                                },
                                "marketing_start_date": {
                                  "type": "string",
                                  "description": "Date when marketing started for this package"
                                },
                                "sample": {
                                  "type": "boolean",
                                  "description": "Whether this package is a sample"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid input parameters"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    }
  },
  "/pharmacy/bulk_ndc_search": {
    "get": {
      "operationId": "bulkNdcSearch",
      "summary": "Comprehensive NDC search with multi-page aggregation",
      "description": "Retrieves complete NDC listings for medications, overcoming pagination limitations. Designed for CSV exports and bulk data retrieval with up to 1000 results.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Brand or generic name of the drug",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "active_ingredient",
          "in": "query",
          "description": "Active ingredient in the drug",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "manufacturer",
          "in": "query",
          "description": "Name of the manufacturer",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "max_results",
          "in": "query",
          "description": "Maximum number of total results to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 1000
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with complete NDC product information",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "Original search query used"
                  },
                  "total_results": {
                    "type": "integer",
                    "description": "Total number of results in the database"
                  },
                  "displayed_results": {
                    "type": "integer",
                    "description": "Number of results returned in this response"
                  },
                  "complete": {
                    "type": "boolean",
                    "description": "Whether all available results were retrieved"
                  },
                  "products": {
                    "type": "array",
                    "description": "List of drug products matching the search criteria",
                    "items": {
                      "type": "object",
                      "properties": {
                        "product_ndc": {
                          "type": "string",
                          "description": "Product-level NDC"
                        },
                        "brand_name": {
                          "type": "string",
                          "description": "Brand name of the product"
                        },
                        "generic_name": {
                          "type": "string",
                          "description": "Generic name of the product"
                        },
                        "dosage_form": {
                          "type": "string",
                          "description": "Dosage form (tablet, capsule, etc.)"
                        },
                        "route": {
                          "type": "string",
                          "description": "Administration route"
                        },
                        "marketing_status": {
                          "type": "string",
                          "description": "Marketing status of the product"
                        },
                        "packaging": {
                          "type": "array",
                          "description": "Package-level details including NDCs",
                          "items": {
                            "type": "object",
                            "properties": {
                              "package_ndc": {
                                "type": "string",
                                "description": "Package-level NDC (for CSV output)"
                              },
                              "description": {
                                "type": "string",
                                "description": "Package description"
                              },
                              "marketing_start_date": {
                                "type": "string",
                                "description": "Date when marketing started"
                              },
                              "sample": {
                                "type": "boolean",
                                "description": "Whether this is a sample package"
                              }
                            }
                          }
                        },
                        "active_ingredients": {
                          "type": "array",
                          "description": "List of active ingredients",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "description": "Name of active ingredient"
                              },
                              "strength": {
                                "type": "string",
                                "description": "Strength of active ingredient"
                              }
                            }
                          }
                        },
                        "manufacturer_name": {
                          "type": "string",
                          "description": "Name of the manufacturer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request - missing required parameters"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/fda/orange-book/search": {
    "get": {
      "operationId": "searchOrangeBook",
      "summary": "Search FDA Orange Book for drug products and therapeutic equivalence",
      "description": "RECOMMENDED ENDPOINT for therapeutic equivalence queries. Search the FDA Orange Book to find drug products and their therapeutic equivalence ratings (AB ratings). This is the most reliable endpoint for determining if drugs have therapeutic equivalence.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name (brand or generic)",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "active_ingredient",
          "in": "query",
          "description": "Active ingredient name",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "appl_no",
          "in": "query",
          "description": "FDA application number",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "ndc",
          "in": "query",
          "description": "NDC product code",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "limit",
          "in": "query",
          "description": "Maximum number of results to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 10
          }
        },
        {
          "name": "skip",
          "in": "query",
          "description": "Number of results to skip for pagination",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 0
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with Orange Book products",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "The search query used"
                  },
                  "total_results": {
                    "type": "integer",
                    "description": "Total number of matching results"
                  },
                  "displayed_results": {
                    "type": "integer",
                    "description": "Number of results in this response"
                  },
                  "products": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "appl_no": {
                          "type": "string",
                          "description": "FDA application number"
                        },
                        "product_no": {
                          "type": "string",
                          "description": "FDA product number"
                        },
                        "form": {
                          "type": "string",
                          "description": "Dosage form"
                        },
                        "strength": {
                          "type": "string",
                          "description": "Product strength"
                        },
                        "reference_drug": {
                          "type": "boolean",
                          "description": "Whether this is a reference listed drug"
                        },
                        "drug_name": {
                          "type": "string",
                          "description": "Drug name (brand or generic)"
                        },
                        "active_ingredient": {
                          "type": "string",
                          "description": "Active ingredient(s)"
                        },
                        "reference_standard": {
                          "type": "boolean",
                          "description": "Whether this is an FDA reference standard"
                        },
                        "te_code": {
                          "type": "string",
                          "description": "Therapeutic equivalence code (e.g., AB, AB1, etc.)"
                        },
                        "applicant": {
                          "type": "string",
                          "description": "Company that applied for FDA approval"
                        },
                        "approval_date": {
                          "type": "string",
                          "description": "Date of FDA approval"
                        },
                        "product_id": {
                          "type": "string",
                          "description": "FDA product ID (often related to NDC)"
                        },
                        "market_status": {
                          "type": "string",
                          "description": "Marketing status (e.g., Prescription)"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request - Invalid input parameters"
        },
        "404": {
          "description": "No matching products found"
        },
        "500": {
          "description": "Internal server error"
        }
      }
    }
  },
  "/export/orange-book/export": {
    "get": {
      "operationId": "exportOrangeBookData",
      "summary": "Export FDA Orange Book data as formatted CSV or JSON",
      "description": "Export FDA Orange Book therapeutic equivalence data in a ready-to-use format. The output is available as CSV (default) or JSON and includes all relevant therapeutic equivalence details. This endpoint is optimized for data export to external systems or for AI assistants that need formatted data.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name to search for",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "active_ingredient",
          "in": "query",
          "description": "Active ingredient to search for",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "format",
          "in": "query",
          "description": "Output format (csv or json)",
          "required": false,
          "schema": {
            "type": "string",
            "enum": ["csv", "json"],
            "default": "csv"
          }
        },
        {
          "name": "limit",
          "in": "query",
          "description": "Maximum number of results to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 100
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with formatted Orange Book data",
          "content": {
            "text/csv": {
              "schema": {
                "type": "string"
              }
            },
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "400": {
          "description": "Bad request - missing required parameters"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/export/dailymed/search": {
    "get": {
      "operationId": "searchDailyMedData",
      "summary": "Search DailyMed for drug information",
      "description": "Search DailyMed for drug information when FDA API data is insufficient. Returns search results with drug names and URLs.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name to search for",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "limit",
          "in": "query",
          "description": "Maximum number of search results to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 5
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful search results from DailyMed",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {"type": "string"},
                  "total_results": {"type": "integer"},
                  "results": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "drug_name": {"type": "string"},
                        "url": {"type": "string"},
                        "set_id": {"type": "string"},
                        "manufacturer": {"type": "string"}
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/fda/dailymed-fallback": {
    "get": {
      "operationId": "searchDailyMedDrugs",
      "summary": "Search DailyMed for drug products",
      "description": "Search DailyMed for drug products by name using improved search extraction. Returns a list of matching drugs with metadata.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name to search for",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with DailyMed search results",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "setid": {
                      "type": "string",
                      "description": "DailyMed set ID for the drug"
                    },
                    "title": {
                      "type": "string",
                      "description": "Drug title including brand/generic name and manufacturer"
                    },
                    "spl_version": {
                      "type": "integer",
                      "description": "SPL version number"
                    },
                    "publication_date": {
                      "type": ["string", "null"],
                      "description": "Publication date of the drug information"
                    },
                    "source": {
                      "type": "string",
                      "description": "Source of the drug data, always 'dailymed' for this endpoint"
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request - missing required parameters"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/fda/dailymed-fallback/spl/{setid}": {
    "get": {
      "operationId": "getDailyMedSplData",
      "summary": "Get comprehensive DailyMed SPL data for a drug",
      "description": "Retrieve enhanced drug data from DailyMed using the improved clinical section extraction. Returns complete clinical sections, active/inactive ingredients, tables, and metadata.",
      "parameters": [
        {
          "name": "setid",
          "in": "path",
          "description": "DailyMed set ID for the drug",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with comprehensive drug data",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "metadata": {
                    "type": "object",
                    "properties": {
                      "set_id": {
                        "type": "string",
                        "description": "DailyMed set ID"
                      },
                      "drug_name": {
                        "type": "string",
                        "description": "Name of the drug"
                      },
                      "manufacturer": {
                        "type": "string",
                        "description": "Manufacturer of the drug"
                      },
                      "drug_class": {
                        "type": "string",
                        "description": "Drug class"
                      },
                      "ndc_codes": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "description": "List of NDC codes for the drug"
                      },
                      "url": {
                        "type": "string",
                        "description": "URL to the DailyMed page"
                      }
                    }
                  },
                  "ingredients": {
                    "type": "object",
                    "properties": {
                      "active": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "description": "List of active ingredients"
                      },
                      "inactive": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "description": "List of inactive ingredients"
                      }
                    }
                  },
                  "clinical_sections": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    },
                    "description": "Clinical sections like INDICATIONS AND USAGE, DOSAGE AND ADMINISTRATION, etc."
                  },
                  "sections": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    },
                    "description": "Additional sections from the drug label"
                  },
                  "tables": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "HTML tables from the drug label"
                  }
                }
              }
            }
          }
        },
        "404": {
          "description": "Drug not found in DailyMed with the given set ID"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/export/dailymed/drug": {
    "get": {
      "operationId": "getDailyMedDrugData",
      "summary": "Get detailed drug information from DailyMed",
      "description": "Retrieve comprehensive drug information from DailyMed including sections from the drug label, tables, and basic metadata.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name to search for and retrieve data",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "format",
          "in": "query",
          "description": "Output format (csv or json)",
          "required": false,
          "schema": {
            "type": "string",
            "enum": ["csv", "json"],
            "default": "json"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with drug data",
          "content": {
            "text/csv": {
              "schema": {"type": "string"}
            },
            "application/json": {
              "schema": {"type": "object"}
            }
          }
        },
        "404": {
          "description": "Drug not found in DailyMed"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/export/fda/label-fallback": {
    "get": {
      "operationId": "getDrugLabelWithFallback",
      "summary": "Get drug label with DailyMed fallback",
      "description": "Retrieve drug label information with automatic fallback to DailyMed if FDA APIs don't return sufficient data.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Drug name to search for",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "format",
          "in": "query",
          "description": "Output format (csv or json)",
          "required": false,
          "schema": {
            "type": "string",
            "enum": ["csv", "json"],
            "default": "json"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with drug label information",
          "content": {
            "text/csv": {
              "schema": {"type": "string"}
            },
            "application/json": {
              "schema": {"type": "object"}
            }
          }
        },
        "404": {
          "description": "Drug not found in FDA or DailyMed"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/export/ndc/export": {
    "get": {
      "operationId": "exportNdcData",
      "summary": "Export NDC data as formatted CSV or JSON",
      "description": "Export National Drug Code (NDC) data in a ready-to-use format. The output is available as CSV (default) or JSON and includes all product and packaging details. This endpoint is optimized for data export to external systems or for AI assistants that need formatted NDC data.",
      "parameters": [
        {
          "name": "name",
          "in": "query",
          "description": "Brand or generic name of the drug",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "active_ingredient",
          "in": "query",
          "description": "Active ingredient in the drug",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "manufacturer",
          "in": "query",
          "description": "Name of the manufacturer",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "format",
          "in": "query",
          "description": "Output format (csv or json)",
          "required": false,
          "schema": {
            "type": "string",
            "enum": ["csv", "json"],
            "default": "csv"
          }
        },
        {
          "name": "filter_dosage_form",
          "in": "query",
          "description": "Optional filter for specific dosage forms (e.g. 'TABLET')",
          "required": false,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "max_results",
          "in": "query",
          "description": "Maximum number of total results to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 1000
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with formatted NDC data",
          "content": {
            "text/csv": {
              "schema": {
                "type": "string"
              }
            },
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "400": {
          "description": "Bad request - missing required parameters"
        },
        "500": {
          "description": "Server error processing the request"
        }
      }
    }
  },
  "/fda/orange-book/equivalent-products": {
    "get": {
      "operationId": "findTherapeuticEquivalents",
      "summary": "Find therapeutically equivalent products",
      "description": "Find all therapeutically equivalent products (generics/brands) for a given drug NDC. Shows AB ratings and equivalence codes.",
      "parameters": [
        {
          "name": "ndc",
          "in": "query",
          "description": "NDC product code to find equivalents for",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "limit",
          "in": "query",
          "description": "Maximum number of equivalent products to return",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 20
          }
        },
        {
          "name": "skip",
          "in": "query",
          "description": "Number of results to skip for pagination",
          "required": false,
          "schema": {
            "type": "integer",
            "default": 0
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Successful response with therapeutically equivalent products",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "Description of the equivalence search"
                  },
                  "total_results": {
                    "type": "integer",
                    "description": "Total number of equivalent products"
                  },
                  "displayed_results": {
                    "type": "integer",
                    "description": "Number of products in this response"
                  },
                  "products": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "appl_no": {
                          "type": "string",
                          "description": "FDA application number"
                        },
                        "product_no": {
                          "type": "string",
                          "description": "FDA product number"
                        },
                        "form": {
                          "type": "string",
                          "description": "Dosage form"
                        },
                        "strength": {
                          "type": "string",
                          "description": "Product strength"
                        },
                        "reference_drug": {
                          "type": "boolean",
                          "description": "Whether this is a reference listed drug"
                        },
                        "drug_name": {
                          "type": "string",
                          "description": "Drug name (brand or generic)"
                        },
                        "active_ingredient": {
                          "type": "string",
                          "description": "Active ingredient(s)"
                        },
                        "reference_standard": {
                          "type": "boolean",
                          "description": "Whether this is an FDA reference standard"
                        },
                        "te_code": {
                          "type": "string",
                          "description": "Therapeutic equivalence code (AB rating)"
                        },
                        "applicant": {
                          "type": "string",
                          "description": "Company that applied for FDA approval"
                        },
                        "approval_date": {
                          "type": "string",
                          "description": "Date of FDA approval"
                        },
                        "product_id": {
                          "type": "string",
                          "description": "FDA product ID (often related to NDC)"
                        },
                        "market_status": {
                          "type": "string",
                          "description": "Marketing status (e.g., Prescription)"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "Bad request - Invalid input parameters"
        },
        "404": {
          "description": "Reference product not found"
        },
        "500": {
          "description": "Internal server error"
        }
      }
    }
  }
}
